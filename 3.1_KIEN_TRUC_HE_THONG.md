# 3. PHÂN TÍCH VÀ THIẾT KẾ HỆ THỐNG

## 3.1. Kiến trúc hệ thống

Hệ thống mạng xã hội Favi được xây dựng dựa trên mô hình kiến trúc ba tầng (Three-tier Architecture), đảm bảo sự phân tách rõ ràng giữa giao diện, logic nghiệp vụ và lưu trữ dữ liệu. Kiến trúc này giúp hệ thống dễ dàng bảo trì, mở rộng và kiểm thử.

Hệ thống bao gồm ba phân hệ chính:

1.  **Presentation Layer (Tầng Giao diện):**
    *   Đảm nhận vai trò tương tác trực tiếp với người dùng cuối (User).
    *   Được xây dựng bằng **Next.js 15**, kết hợp cơ chế Server-Side Rendering (SSR) để tối ưu hóa SEO và Client-Side Rendering (CSR) để tạo trải nghiệm mượt mà.
    *   Giao tiếp với tầng Business thông qua các lệnh gọi RESTful API.

2.  **Business Layer (Tầng Nghiệp vụ):**
    *   Là trung tâm xử lý logic của hệ thống, được xây dựng trên nền tảng **ASP.NET Core 8 Web API**.
    *   Tầng này chịu trách nhiệm: xác thực người dùng (Auth), xử lý ngữ nghĩa bài viết, điều phối luồng dữ liệu và thực thi các quy tắc nghiệp vụ (Validation).
    *   Được tổ chức theo mô hình **Controller – Service – Repository**, giúp tách biệt code xử lý API và code truy xuất dữ liệu.

3.  **Data Layer (Tầng Dữ liệu):**
    *   Chịu trách nhiệm lưu trữ và truy xuất dữ liệu bền vững.
    *   **PostgreSQL:** Lưu trữ dữ liệu quan hệ (User, Post, Comment).
    *   **Redis:** Đóng vai trò Cache layer và Message Broker cho tính năng Real-time.
    *   **Qdrant:** Cơ sở dữ liệu Vector chuyên dụng để lưu trữ Embeddings phục vụ tính năng tìm kiếm thông minh.

**Nguyên tắc tương tác:**
Tuân thủ nguyên tắc "Loose Coupling" (Liên kết lỏng lẻo): Các tầng chỉ giao tiếp với nhau qua các giao diện (Interface) được định nghĩa sẵn. Tầng Giao diện không bao giờ truy cập trực tiếp vào Cơ sở dữ liệu mà bắt buộc phải thông qua API của Tầng Nghiệp vụ. Kiến trúc này cũng áp dụng triệt để **Dependency Injection (DI)** để quản lý các phụ thuộc giữa các thành phần.
